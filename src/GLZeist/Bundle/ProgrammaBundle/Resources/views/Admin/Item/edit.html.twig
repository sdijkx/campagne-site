{% extends "GLZeistProgrammaBundle::admin.html.twig" %} {%block content%}<h1>Item edit</h1>

<form action="{{ path('item_update', { 'id': entity.id }) }}" method="post" {{ form_enctype(edit_form) }}>
    
    {{ form_row(edit_form.titel) }}
    {{ form_row(edit_form.kernboodschap) }}
    <div class="form_row">
        <label>Tweet</label>
        {{ form_widget(edit_form.tweet) }}
        <div id="wordcount">{{entity.tweet|length}}</div>
    </div>
    {{ form_row(edit_form.voorstellen) }}
    {{ form_row(edit_form.verantwoording) }}
    {{ form_row(edit_form.hoofdtekst) }}
    <div class="form_row">
        <label>Afbeedling</label>
        <div class="upload_image">
            <img src="{{path('file',{filename:entity.imagefile})}}" />
            <img src="{{path('file',{filename:entity.thumbfile})}}" />
            {{ form_widget(edit_form.file) }}
            <input type=submit value="Opslaan" />
        </div>
    </div>
    
    
    <div class="form_row">
        <label>Youtube Video</label>
        <div class="video">
            {%if entity.video %}

                <iframe id="ytplayer" type="text/html" width="640" height="360"
                src="https://www.youtube.com/embed/{{entity.video}}"
                frameborder="0" allowfullscreen ></iframe>

            {%endif%}   
            {{ form_widget(edit_form.video) }}
            <input type=submit value="Opslaan" />
        </div>

    </div>

    {{ form_row(edit_form.trefwoorden) }}
    {{ form_row(edit_form.thema) }}
    {{ form_row(edit_form.relaties) }}
    <div class="form_row">
        {{ form_label(edit_form.links) }}
        {{ form_widget(edit_form.links) }}
        <a href="#" id="add-link">Link toevoegen</a>
    </div>

    {{ form_row(edit_form._token) }}

    <p>
        <button type="submit">Opslaan</button>
    </p>
</form>

<ul class="record_actions">
    <li>
        <a href="{{ path('admin_item') }}">
            Terug naar het overzicht
        </a>
    </li>
    <li>
        <form action="{{ path('item_delete', { 'id': entity.id }) }}" method="post">
            {{ form_widget(delete_form) }}
            <button type="submit">Verwijderen</button>
        </form>
    </li>
</ul>
<script>
    CKEDITOR.replace('glzeist_bundle_programmabundle_itemtype_kernboodschap');
    CKEDITOR.replace('glzeist_bundle_programmabundle_itemtype_hoofdtekst');
    CKEDITOR.replace('glzeist_bundle_programmabundle_itemtype_voorstellen');
    CKEDITOR.replace('glzeist_bundle_programmabundle_itemtype_verantwoording');

    $("#glzeist_bundle_programmabundle_itemtype_tweet").keyup(function(){
        var max=100;
        
        var len= $(this).val().length;
        
        $("#wordcount").html(len);

        if(len>max)
        {
            if(!$('#wordcount').hasClass('error'))
            {
                $('#wordcount').addClass('error');
            }
        }
        else
        {
            $('#wordcount').removeClass('error');
        }
    }).keyup();

    var linkCount = '{{ edit_form.links | length }}';


    function appendRemoveLink(n)
    {
        $(n).append('<a href="#" class="button remove-link">Verwijderen</a>');
    }

    $('#add-link').click(function() {
        var list = jQuery('#glzeist_bundle_programmabundle_itemtype_links');

        var newWidget = list.attr('data-prototype');

        newWidget = newWidget.replace(/__name__label__/g, '');
        newWidget = newWidget.replace(/__name__/g, linkCount);
        linkCount++;

        var newDiv = jQuery(newWidget);
        appendRemoveLink(newDiv);
        newDiv.appendTo(list);
    

        return false;
    });

    $('#glzeist_bundle_programmabundle_itemtype_links > div.form_row').each(function(i,n)
    {
        appendRemoveLink(n);
    });

    $('#glzeist_bundle_programmabundle_itemtype_links').on('click','a.remove-link', function(){
        $(this).parent().remove();
        return false;
    });


</script>
{%endblock%}